@startuml Feature Modules
!theme plain
skinparam componentStyle uml2
skinparam shadowing false
skinparam roundcorner 15
skinparam monochrome true
skinparam backgroundColor #F9F9F9
skinparam ArrowColor Black
skinparam ArrowFontColor Black
skinparam defaultFontName "Nanum Gothic"

title Feature Modules Architecture

legend top
  **Feature Module Architecture Overview:**

  üèóÔ∏è **Modular Design**: Each feature is self-contained with its own domain, application, and presentation layers
  üîÑ **Separation of Concerns**: Clear boundaries between different business domains
  üì¶ **Reusability**: Shared components and utilities are centralized
  üß™ **Testability**: Each feature can be tested independently
  üîß **Maintainability**: Changes to one feature don't affect others

  **Key Principles:**
  ‚úÖ Feature-based organization
  ‚úÖ Clean architecture within features
  ‚úÖ Shared component library
  ‚úÖ Cross-feature communication patterns
  ‚úÖ Consistent naming conventions
end legend

package "Features" as Features {
  package "Auth Feature" as AuthFeature {
    package "Domain" as AuthDomain {
      interface "AuthUseCase" as IAuthUseCase {
        + login(email, password) : AuthResponse
        + logout() : void
        + refreshToken(token) : RefreshResponse
      }

      interface "PermissionUseCase" as IPermissionUseCase {
        + getMyPermissions() : Permission[]
        + checkPermission(resource, action) : boolean
      }
    }

    package "Application" as AuthApplication {
      class "AuthUseCaseImpl" as AuthUseCaseImpl {
        - authService : AuthService
        + login(email, password) : AuthResponse
        + logout() : void
      }

      class "PermissionUseCaseImpl" as PermissionUseCaseImpl {
        - permissionService : PermissionService
        + getMyPermissions() : Permission[]
        + checkPermission(resource, action) : boolean
      }

      class "AuthStore" as AuthStore {
        - user : AdminUser (nullable)
        - permissions : Permission[]
        + login(credentials) : void
        + logout() : void
      }

      class "useAuth" as UseAuth {
        + useAuth() : AuthState
      }
    }

    package "Presentation" as AuthPresentation {
      class "LoginPage" as LoginPage
      class "PermissionGuard" as PermissionGuard
      class "AuthProvider" as AuthProvider
    }
  }

note right of AuthFeature
  **Authentication & Authorization Feature:**

  üîê **Core Responsibilities**:
  ‚Ä¢ User authentication (login/logout)
  ‚Ä¢ Token management and refresh
  ‚Ä¢ Permission-based access control
  ‚Ä¢ Role-based authorization
  ‚Ä¢ Session management

  üèóÔ∏è **Architecture Layers**:
  ‚Ä¢ **Domain**: Auth and permission interfaces
  ‚Ä¢ **Application**: Business logic implementation
  ‚Ä¢ **Presentation**: Login UI and permission guards

  üìä **Key Components**:
  ‚Ä¢ Login/logout functionality
  ‚Ä¢ Permission checking system
  ‚Ä¢ Auth state management
  ‚Ä¢ Route protection guards
  ‚Ä¢ Token refresh mechanism

  üîó **Cross-Feature Dependencies**:
  ‚Ä¢ Required by all other features
  ‚Ä¢ Provides user context and permissions
  ‚Ä¢ Enables feature-level access control
end note

  package "Users Feature" as UsersFeature {
    package "Domain" as UsersDomain {
      interface "UserManagementUseCase" as IUserManagement {
        + getAllUsers(filters) : AdminUser[]
        + approveUser(userId, data) : AdminUser
        + updateUser(userId, data) : AdminUser
      }
    }

    package "Application" as UsersApplication {
      class "UserManagementUseCaseImpl" as UserManagementImpl {
        - userService : UserService
        + getAllUsers(filters) : AdminUser[]
        + approveUser(userId, data) : AdminUser
      }

      class "UserStore" as UserStore {
        - users : AdminUser[]
        - selectedUsers : string[]
        + setUsers(users) : void
        + addUser(user) : void
      }

      class "useUsers" as UseUsers {
        + useUsers(filters) : UseQueryResult
      }
    }

    package "Presentation" as UsersPresentation {
      class "UserManagementPage" as UserManagementPage
      class "UserTable" as UserTable
      class "UserApprovalModal" as UserApprovalModal
    }
  }

note right of UsersFeature
  **User Management Feature:**

  üë• **Core Responsibilities**:
  ‚Ä¢ Admin user CRUD operations
  ‚Ä¢ User approval workflow
  ‚Ä¢ Bulk user operations
  ‚Ä¢ User filtering and search
  ‚Ä¢ User status management

  üèóÔ∏è **Architecture Layers**:
  ‚Ä¢ **Domain**: User management interfaces
  ‚Ä¢ **Application**: Business logic and state management
  ‚Ä¢ **Presentation**: User management UI components

  üìä **Key Components**:
  ‚Ä¢ User list and table views
  ‚Ä¢ User approval modals
  ‚Ä¢ Bulk action functionality
  ‚Ä¢ Advanced filtering system
  ‚Ä¢ User detail management

  üîó **Cross-Feature Dependencies**:
  ‚Ä¢ Depends on Auth feature for permissions
  ‚Ä¢ Integrates with Dashboard for user statistics
  ‚Ä¢ May interact with Wallet feature for user transactions
end note

  package "Dashboard Feature" as DashboardFeature {
    package "Domain" as DashboardDomain {
      interface "DashboardUseCase" as IDashboardUseCase {
        + getStats() : DashboardStats
        + getRecentActivities() : Activity[]
      }
    }

    package "Application" as DashboardApplication {
      class "DashboardUseCaseImpl" as DashboardUseCaseImpl {
        - dashboardService : DashboardService
        + getStats() : DashboardStats
        + getRecentActivities() : Activity[]
      }

      class "useDashboard" as UseDashboard {
        + useDashboardStats() : UseQueryResult
      }
    }

    package "Presentation" as DashboardPresentation {
      class "DashboardPage" as DashboardPage
      class "StatsCard" as StatsCard
      class "ActivityFeed" as ActivityFeed
    }
  }

note right of DashboardFeature
  **Dashboard & Analytics Feature:**

  üìä **Core Responsibilities**:
  ‚Ä¢ System statistics and metrics
  ‚Ä¢ Recent activity monitoring
  ‚Ä¢ Real-time data updates
  ‚Ä¢ Performance indicators
  ‚Ä¢ Business intelligence

  üèóÔ∏è **Architecture Layers**:
  ‚Ä¢ **Domain**: Dashboard interfaces
  ‚Ä¢ **Application**: Data aggregation logic
  ‚Ä¢ **Presentation**: Dashboard UI components

  üìä **Key Components**:
  ‚Ä¢ Statistics cards and widgets
  ‚Ä¢ Activity feed and timeline
  ‚Ä¢ Real-time data updates
  ‚Ä¢ Performance charts
  ‚Ä¢ System health indicators

  üîó **Cross-Feature Dependencies**:
  ‚Ä¢ Depends on Auth for user context
  ‚Ä¢ Aggregates data from Users feature
  ‚Ä¢ May integrate with Wallet for transaction stats
  ‚Ä¢ Provides overview of all system activities
end note
}

package "Shared" as Shared {
  package "Domain" as SharedDomain {
    interface "BaseUseCase" as IBaseUseCase
    class "UseCaseContext" as UseCaseContext
    class "UseCaseResult" as UseCaseResult
  }

  package "Application" as SharedApplication {
    class "UseCaseExecutor" as UseCaseExecutor
    class "ApiService" as ApiService
    class "ErrorHandler" as ErrorHandler
  }

  package "Components" as SharedComponents {
    class "LoadingSpinner" as LoadingSpinner
    class "ConfirmModal" as ConfirmModal
    class "PageHeader" as PageHeader
  }
}

note right of Shared
  **Shared Module:**

  üîß **Core Responsibilities**:
  ‚Ä¢ Common interfaces and base classes
  ‚Ä¢ Reusable utility services
  ‚Ä¢ Shared UI components
  ‚Ä¢ Cross-cutting concerns
  ‚Ä¢ Infrastructure services

  üèóÔ∏è **Architecture Layers**:
  ‚Ä¢ **Domain**: Base interfaces and common types
  ‚Ä¢ **Application**: Shared services and utilities
  ‚Ä¢ **Components**: Reusable UI components

  üìä **Key Components**:
  ‚Ä¢ Base use case interfaces
  ‚Ä¢ API service and error handling
  ‚Ä¢ Common UI components (modals, spinners)
  ‚Ä¢ Utility functions and helpers
  ‚Ä¢ Cross-cutting middleware

  üîó **Usage Pattern**:
  ‚Ä¢ Imported by all feature modules
  ‚Ä¢ Provides foundation for feature development
  ‚Ä¢ Ensures consistency across features
  ‚Ä¢ Reduces code duplication
end note

' Feature dependencies
AuthFeature --> Shared : uses
UsersFeature --> Shared : uses
DashboardFeature --> Shared : uses

' Internal dependencies
AuthApplication --> AuthDomain : implements
AuthPresentation --> AuthApplication : uses
UsersApplication --> UsersDomain : implements
UsersPresentation --> UsersApplication : uses
DashboardApplication --> DashboardDomain : implements
DashboardPresentation --> DashboardApplication : uses

' Cross-feature dependencies
UsersFeature --> AuthFeature : depends on (permissions)
DashboardFeature --> AuthFeature : depends on (authentication)

note as N_CrossFeatureCommunication
  **Cross-Feature Communication Patterns:**

  üîó **Dependency Types**:
  ‚Ä¢ **Direct Dependencies**: Features directly import from other features
  ‚Ä¢ **Event-Based**: Features communicate through events
  ‚Ä¢ **Shared State**: Features share state through global stores
  ‚Ä¢ **Service Layer**: Features communicate through shared services

  üìä **Communication Examples**:
  ‚Ä¢ Auth ‚Üí All Features: User context and permissions
  ‚Ä¢ Users ‚Üí Dashboard: User statistics and metrics
  ‚Ä¢ Dashboard ‚Üí All Features: System-wide notifications

  üõ°Ô∏è **Best Practices**:
  ‚Ä¢ Minimize cross-feature dependencies
  ‚Ä¢ Use interfaces for feature boundaries
  ‚Ä¢ Implement event-driven communication
  ‚Ä¢ Keep shared state minimal
  ‚Ä¢ Document feature interfaces clearly
end note

AuthFeature .. N_CrossFeatureCommunication
UsersFeature .. N_CrossFeatureCommunication
DashboardFeature .. N_CrossFeatureCommunication

note as N_ImplementationExample
  **Feature Module Implementation Example:**

  <code>
  // Feature Structure
  features/
    auth/
      domain/
        use-cases/
          auth.use-case.interface.ts
      application/
        use-cases/
          auth.use-case.ts
        hooks/
          useAuth.ts
        stores/
          auth.store.ts
      presentation/
        pages/
          LoginPage.tsx
        components/
          PermissionGuard.tsx

  // Cross-Feature Usage
  // In Users feature
  import { useAuth } from '@/features/auth/application/hooks/useAuth';
  import { PermissionGuard } from '@/features/auth/presentation/components/PermissionGuard';

  // In Dashboard feature
  import { useAuth } from '@/features/auth/application/hooks/useAuth';
  import { useUsers } from '@/features/users/application/hooks/useUsers';

  // Shared Module Usage
  import { ApiService } from '@/shared/application/services/api.service';
  import { LoadingSpinner } from '@/shared/components/common/LoadingSpinner';
  </code>
end note

AuthFeature .. N_ImplementationExample
UsersFeature .. N_ImplementationExample
DashboardFeature .. N_ImplementationExample
Shared .. N_ImplementationExample

@enduml
